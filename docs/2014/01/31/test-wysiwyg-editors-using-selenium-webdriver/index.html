<!DOCTYPE html> <!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"><![endif]--> <!--[if IE 7]><html class="no-js lt-ie9 lt-ie8"><![endif]--> <!--[if IE 8]><html class="no-js lt-ie9"><![endif]--> <!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]--> <head> <meta charset="utf-8"> <!--[if IE]><meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'><![endif]--> <meta name="viewport" content="width=device-width,initial-scale=1"> <title>Test WYSIWYG editors using Selenium WebDriver | Yi Zeng’s Blog</title> <meta name="generator" content="Jekyll v3.9.3"/> <meta property="og:title" content="Test WYSIWYG editors using Selenium WebDriver"/> <meta name="author" content="Yi Zeng"/> <meta property="og:locale" content="en"/> <meta name="description" content="How to write automated UI functional tests for WYSIWYG HTML editors like TinyMCE, CKEditor, CLEditor, CuteEditor and Primefaces editor using Selenium WebDriver Ruby binding."/> <meta property="og:description" content="How to write automated UI functional tests for WYSIWYG HTML editors like TinyMCE, CKEditor, CLEditor, CuteEditor and Primefaces editor using Selenium WebDriver Ruby binding."/> <link rel="canonical" href="http://yizeng.me/2014/01/31/test-wysiwyg-editors-using-selenium-webdriver/"/> <meta property="og:url" content="http://yizeng.me/2014/01/31/test-wysiwyg-editors-using-selenium-webdriver/"/> <meta property="og:site_name" content="Yi Zeng’s Blog"/> <meta property="og:type" content="article"/> <meta property="article:published_time" content="2014-01-31T00:00:00+01:00"/> <meta name="twitter:card" content="summary"/> <meta property="twitter:title" content="Test WYSIWYG editors using Selenium WebDriver"/> <script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Yi Zeng"},"dateModified":"2014-01-31T00:00:00+01:00","datePublished":"2014-01-31T00:00:00+01:00","description":"How to write automated UI functional tests for WYSIWYG HTML editors like TinyMCE, CKEditor, CLEditor, CuteEditor and Primefaces editor using Selenium WebDriver Ruby binding.","headline":"Test WYSIWYG editors using Selenium WebDriver","mainEntityOfPage":{"@type":"WebPage","@id":"http://yizeng.me/2014/01/31/test-wysiwyg-editors-using-selenium-webdriver/"},"url":"http://yizeng.me/2014/01/31/test-wysiwyg-editors-using-selenium-webdriver/"}</script> <meta name="keywords" content="ruby,selenium webdriver"/> <link type="application/atom+xml" rel="alternate" href="http://yizeng.me/feed.xml" title="Yi Zeng’s Blog"/> <link href='/assets/stylesheets/blog.css' rel="stylesheet" type="text/css"> <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script> <script>window.Modernizr||document.write('<script src="/assets/javascripts/modernizr-2.8.3.min.js"><\/script>');</script> <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> <script>window.jQuery||document.write('<script src="/assets/javascripts/jquery-3.3.1.min.js"><\/script>');</script> <script src="//cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script> <script>window.Pace||document.write('<script src="/assets/javascripts/pace.min.js"><\/script>');</script> <script>(function(b,m,h,a,g){b[a]=b[a]||[];b[a].push({"gtm.start":new Date().getTime(),event:"gtm.js"});var k=m.getElementsByTagName(h)[0],e=m.createElement(h),c=a!="dataLayer"?"&l="+a:"";e.async=true;e.src="https://www.googletagmanager.com/gtm.js?id="+g+c;k.parentNode.insertBefore(e,k)})(window,document,"script","dataLayer","GTM-P5NFP45");</script> </head> <body> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P5NFP45" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript> <!--[if IE]><p class="site-notice">You are using an outdated browser. Please <a href="http://browsehappy.com/" target="_blank">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true" target="_blank">activate Google Chrome Frame</a> to improve your experience.</p><![endif]--> <noscript> <p class="site-notice">This site requires JavaScript. Here are the instructions <a href="http://www.enable-javascript.com/" target="_blank">how to enable JavaScript in your web browser</a>.</p> </noscript> <div class="nav-wrapper overlay-wrapper"> <div class="nav-form overlay-form"> <span class="overlay-header menu">Menu</span> <a class="btn-close">Close</a> <div class="results"> <ul> <li><a href="/blog/categories/">Categories</a></li> <li><a href="/blog/tags/">Tags</a></li> <li><a href="/">About</a></li> </ul> </div> </div> </div> <div class="search-wrapper overlay-wrapper"> <div class="search-form overlay-form"> <input type="text" class="overlay-header search-field" placeholder="Search..."> <a class="btn-close">Close</a> <ul class="results"></ul> </div> </div> <div id="page" class="hentry"> <header class="the-header"> <div class="unit-head"> <div class="unit-inner unit-head-inner"> <nav class="nav-global"> <ul> <li class="logo nav-link"> <button class="btn-menu" title="Menu"></button> <a href="/blog/">Yi Zeng’s Blog</a> <!--[if !IE]>--> <button class="btn-search" title="Search"></button> <!--<![endif]--> </li> <li class="nav-link"><a title="Categories" href="/blog/categories/">Categories</a></li> <li class="nav-link"><a title="Tags" href="/blog/tags/">Tags</a></li> <!--[if !IE]>--> <li class="nav-link"><a title="Search" class="btn-search" href="#">Search</a></li> <!--<![endif]--> </ul> </nav> </div> </div> </header> <div class="body animated fadeInDown" role="main"> <div class="unit-body"> <div class="unit-inner unit-body-inner"> <div class="entry-content"> <article class="unit-article layout-post"> <div class="unit-inner unit-article-inner"> <div itemscope itemtype="http://schema.org/Article" class="content"> <header> <div class="unit-head"> <div class="unit-inner unit-head-inner"> <h1 class="entry-title" itemprop="name">Test WYSIWYG editors using Selenium WebDriver</h1> </div> </div> </header> <div class="bd article-content"> <div class="entry-content"> <div class="meta"> <p class="date-publish"> Published: <time itemprop="datePublished" class="date-pub updated" title="2014-01-31T00:00:00+01:00" datetime="2014-01-31T00:00:00+01:00">January 31, 2014 </time> by <a class="author" href="/" rel="author" title="Show Author"> <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name">Yi Zeng</span> </span> </a> <a class="license-icon" rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" title="Show License"> <img alt="Creative Commons Licence" style="border-width:0" src="/assets/images/theme/cc-by-sa.png" height="16" width="80"/> </a> </p> <ul class="list-category list-linear"> <li class="list-head">Categories: </li> <li> <a href="/blog/categories/#tutorials" title="tutorials"> tutorials <span>26</span></a> </li> </ul> <ul class="list-tag list-linear"> <li class="list-head">Tags: </li> <li> <a href="/blog/tags/#ruby" title="ruby">ruby <span>14</span></a> </li> <li> <a href="/blog/tags/#selenium-webdriver" title="selenium webdriver">selenium webdriver <span>16</span></a> </li> </ul> </div> <div itemprop="articleBody"> <blockquote> <p>What is a WYSIWYG HTML editor? <br/>A WYSIWYG HTML editor provides an editing interface which resembles how the page will be displayed in a web browser. Because using a WYSIWYG editor may not require any HTML knowledge, they are often easier for an average computer user to get started with. (<a href="http://en.wikipedia.org/wiki/HTML_editor#WYSIWYG_HTML_editors">Wikipedia</a>)</p> </blockquote> <p>WYSIWYG HTML editors (an acronym for "What You See Is What You Get") are widely used in web applications as embedded text editor nowadays. The most common way of using those editors is framed editing, which uses <code class="language-plaintext highlighter-rouge">&lt;iframe&gt;</code> instead of <code class="language-plaintext highlighter-rouge">&lt;textarea&gt;</code> and displays the content inside the <code class="language-plaintext highlighter-rouge">&lt;body&gt;</code> element, however, it makes the UI automation process a little bit different.</p> <p>Taking <a href="http://ckeditor.com/">CKEditor</a> and <a href="http://www.tinymce.com/">TinyMCE</a> as examples, this article will illustrate:</p> <blockquote> <ol> <li>How to automate these editors using Selenium WebDriver's native Ruby API<br/></li> <li>How to inject JavaScript through Selenium WebDriver to automate using editors' native JavaScript API.</li> </ol> </blockquote> <p>For other editors created with similar technology, for instance, <a href="http://premiumsoftware.net/cleditor">CLEditor</a> (including <a href="http://www.primefaces.org/showcase/ui/input/textEditor.xhtml">Primefaces editor</a>) and <a href="http://cutesoft.net/ASP.NET%2BWYSIWYG%2BEditor/">CuteEditor</a>, the same logic also applies and should work in theory.</p> <ul class="toc" id="markdown-toc"> <li><a href="#heading-wysiwyg-html-editors-comparison" id="markdown-toc-heading-wysiwyg-html-editors-comparison">WYSIWYG HTML editors' comparison</a></li> <li><a href="#heading-demos" id="markdown-toc-heading-demos">Demos</a> <ul> <li><a href="#heading-ckeditor-432-standard" id="markdown-toc-heading-ckeditor-432-standard">CKEditor 4.3.2 Standard</a></li> <li><a href="#heading-tinymce-4015" id="markdown-toc-heading-tinymce-4015">TinyMCE 4.0.15</a></li> </ul> </li> <li><a href="#heading-automate-using-native-selenium-webdriver-api" id="markdown-toc-heading-automate-using-native-selenium-webdriver-api">Automate using native Selenium WebDriver API</a> <ul> <li><a href="#heading-click-toolbar-buttons" id="markdown-toc-heading-click-toolbar-buttons">Click toolbar buttons</a></li> <li><a href="#heading-switch-into-input-iframe" id="markdown-toc-heading-switch-into-input-iframe">Switch into input iframe</a></li> <li><a href="#heading-automate-content" id="markdown-toc-heading-automate-content">Automate content</a></li> </ul> </li> <li><a href="#heading-automate-using-editors-built-in-javascript-api" id="markdown-toc-heading-automate-using-editors-built-in-javascript-api">Automate using editors' built-in JavaScript API</a> <ul> <li><a href="#heading-set-content" id="markdown-toc-heading-set-content">Set content</a></li> <li><a href="#heading-clear-content" id="markdown-toc-heading-clear-content">Clear content</a></li> <li><a href="#heading-insert-content" id="markdown-toc-heading-insert-content">Insert content</a></li> </ul> </li> <li><a href="#heading-examples" id="markdown-toc-heading-examples">Examples</a> <ul> <li><a href="#heading-set-content-using-selenium-webdriver-api" id="markdown-toc-heading-set-content-using-selenium-webdriver-api">Set content using Selenium WebDriver API</a></li> <li><a href="#heading-select-all-content" id="markdown-toc-heading-select-all-content">Select all content</a></li> <li><a href="#heading-click-numbered-list-from-toolbar" id="markdown-toc-heading-click-numbered-list-from-toolbar">Click "Numbered list" from toolbar</a></li> <li><a href="#heading-set-content-using-editors-api" id="markdown-toc-heading-set-content-using-editors-api">Set content using editors' API</a></li> </ul> </li> <li><a href="#heading-references" id="markdown-toc-heading-references">References</a></li> </ul> <h2 id="heading-wysiwyg-html-editors-comparison">WYSIWYG HTML editors' comparison</h2> <div class="data-table"> <table> <thead> <tr> <th></th> <th>CKEditor (Standard)</th> <th>TinyMCE</th> <th>CLEditor</th> </tr> </thead> <tbody> <tr> <td>Homepage</td> <td class="center"><a href="http://ckeditor.com/">ckeditor.com</a></td> <td class="center"><a href="http://www.tinymce.com/">tinymce.com</a></td> <td class="center"><a href="http://premiumsoftware.net/cleditor">premiumsoftware.net</a></td> </tr> <tr> <td>Current version</td> <td class="center">4.3.2</td> <td class="center">4.0.15</td> <td class="center">1.4.4</td> </tr> <tr> <td>License</td> <td class="center"><a href="http://ckeditor.com/about/license">GPL, LGPL and MPL</a></td> <td class="center"><a href="http://www.tinymce.com/js/tinymce4/js/tinymce/license.txt">LGPL</a></td> <td class="center"><a href="http://premiumsoftware.net/cleditor">MIT or GPL v2</a></td> </tr> <tr> <td>Size (Distribution package)</td> <td class="center">1022 kB</td> <td class="center">291.3 kB</td> <td class="center">20.4 kB</td> </tr> <tr> <td>Size (Core .js file)</td> <td class="center">461.2 kB</td> <td class="center">282.7 kB</td> <td class="center">12.5 kB</td> </tr> </tbody> </table> </div> <h2 id="heading-demos">Demos</h2> <h3 id="heading-ckeditor-432-standard">CKEditor 4.3.2 Standard</h3> <textarea id="ckeditor"></textarea> <script type="text/javascript" src="/assets/javascripts/ckeditor/ckeditor.js"></script> <script>CKEDITOR.replace("ckeditor");</script> <h3 id="heading-tinymce-4015">TinyMCE 4.0.15</h3> <textarea id="tinymce-editor"></textarea> <script type="text/javascript" src="/assets/javascripts/tinymce/tinymce.min.js"></script> <script type="text/javascript">tinymce.init({selector:"#tinymce-editor"});</script> <h2 id="heading-automate-using-native-selenium-webdriver-api">Automate using native Selenium WebDriver API</h2> <p>Both CKEditor and TinyMCE are JavaScript based, which means they can be automated using Selenium WebDriver's native API just like any other HTML web applications.</p> <h3 id="heading-click-toolbar-buttons">Click toolbar buttons</h3> <p>WYSIWYG editors normally provide native methods to set raw HTML content directly through API, automating the toolbar doesn't seem to be really necessary. If it's needed to be done for some reason, it shouldn't be much of a problem, because toolbar elements are just ordinary web elements, the automating process is fairly straight-forward without any frame switching required.</p> <blockquote> <ol> <li>Find the elements by appropriate locators according to the HTML markup.</li> <li>Manipulate those elements see if they work or not.</li> </ol> </blockquote> <p>Markup for CKEditor's toolbar "Numbered List" button: <a class="button show-hidden">Show</a></p> <div class="hidden"> <figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;a</span> <span class="na">id=</span><span class="s">"cke_39"</span> <span class="na">class=</span><span class="s">"cke_button cke_button__numberedlist"</span> <span class="na">href=</span><span class="s">"javascript:void('Insert/Remove Numbered List')"</span> <span class="na">title=</span><span class="s">"Insert/Remove Numbered List"</span> <span class="na">role=</span><span class="s">"button"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"cke_button_icon cke_button__numberedlist_icon"</span> <span class="nt">&gt;</span><span class="ni">&amp;nbsp;</span><span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">id=</span><span class="s">"cke_39_label"</span> <span class="na">class=</span><span class="s">"cke_button_label cke_button__numberedlist_label"</span><span class="nt">&gt;</span>Insert/Remove Numbered List<span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;/a&gt;</span></code></pre></figure> </div> <p>Markup for TinyMCE's toolbar "Numbered List" button: <a class="button show-hidden">Show</a></p> <div class="hidden"> <figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"mce_11"</span> <span class="na">class=</span><span class="s">"mce-widget mce-btn"</span> <span class="na">role=</span><span class="s">"button"</span> <span class="na">aria-label=</span><span class="s">"Numbered list"</span> <span class="na">aria-pressed=</span><span class="s">"false"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">"mce-ico mce-i-numlist"</span><span class="nt">&gt;&lt;/i&gt;</span>
    <span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/div&gt;</span></code></pre></figure> </div> <p>Selenium WebDriver Ruby code to click the buttons:</p> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># click CKEditor's 'Numbered List' button</span>
<span class="n">ckeditor_btn_numbered_list</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="nf">find_element</span><span class="p">(</span><span class="ss">:class</span> <span class="o">=&gt;</span> <span class="s2">"cke_button__numberedlist"</span><span class="p">)</span>
<span class="n">ckeditor_btn_numbered_list</span><span class="p">.</span><span class="nf">click</span>

<span class="c1"># click TinyMCE editor's 'Numbered List' button</span>
<span class="n">tinymce_btn_numbered_list</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="nf">find_element</span><span class="p">(</span><span class="ss">:css</span> <span class="o">=&gt;</span> <span class="s2">".mce-btn[aria-label='Numbered list'] button"</span><span class="p">)</span>
<span class="n">tinymce_btn_numbered_list</span><span class="p">.</span><span class="nf">click</span></code></pre></figure> <h3 id="heading-switch-into-input-iframe">Switch into input iframe</h3> <p>Although CKEditor and TinyMCE are initialized with <code class="language-plaintext highlighter-rouge">&lt;textarea&gt;</code> tag, the editor body is actually constructed within an <code class="language-plaintext highlighter-rouge">&lt;iframe&gt;</code>, which is still technically a web element, but all elements inside can only be accessed by WebDriver after switching into the iframe. As seen in the HTML mark up below, CKEditor's iframe can be identified using <code class="language-plaintext highlighter-rouge">class</code>, while TinyMCE's can be located by <code class="language-plaintext highlighter-rouge">id</code> directly. Equivalent CSS Selectors and XPaths also exist if needed.</p> <p>Markup for CKEditor's body: <a class="button show-hidden">Show</a></p> <div class="hidden"> <figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;iframe</span> <span class="na">src=</span><span class="s">""</span> <span class="na">frameborder=</span><span class="s">"0"</span> <span class="na">class=</span><span class="s">"cke_wysiwyg_frame cke_reset"</span> <span class="na">title=</span><span class="s">"Rich Text Editor, ckeditor"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;html</span> <span class="na">dir=</span><span class="s">"ltr"</span> <span class="na">lang=</span><span class="s">"en-gb"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;head&gt;&lt;/head&gt;</span>
        <span class="nt">&lt;body</span> <span class="na">contenteditable=</span><span class="s">"true"</span> <span class="na">class=</span><span class="s">"cke_editable cke_editable_themed cke_contents_ltr"</span> <span class="na">spellcheck=</span><span class="s">"false"</span><span class="nt">&gt;&lt;/body&gt;</span>
    <span class="nt">&lt;/html&gt;</span>
<span class="nt">&lt;/iframe&gt;</span></code></pre></figure> </div> <p>Markup for TinyMCE's body: <a class="button show-hidden">Show</a></p> <div class="hidden"> <figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;iframe</span> <span class="na">id=</span><span class="s">"tinymce-editor_ifr"</span> <span class="na">src=</span><span class="s">'javascript:""'</span> <span class="na">frameborder=</span><span class="s">"0"</span> <span class="na">title=</span><span class="s">"Rich Text Area. Press ALT-F9 for menu. Press ALT-F10 for toolbar. Press ALT-0 for help"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;html&gt;</span>
        <span class="nt">&lt;head&gt;&lt;/head&gt;</span>
        <span class="nt">&lt;body</span> <span class="na">id=</span><span class="s">"tinymce"</span> <span class="na">class=</span><span class="s">"mce-content-body "</span> <span class="na">contenteditable=</span><span class="s">"true"</span> <span class="na">spellcheck=</span><span class="s">"false"</span><span class="nt">&gt;&lt;/body&gt;</span>
    <span class="nt">&lt;/html&gt;</span>
<span class="nt">&lt;/iframe&gt;</span></code></pre></figure> </div> <h4 id="heading-locate-the-iframes">Locate the iframes</h4> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">ckeditor_frame</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="nf">find_element</span><span class="p">(</span><span class="ss">:class</span> <span class="o">=&gt;</span> <span class="s1">'cke_wysiwyg_frame'</span><span class="p">)</span>
<span class="n">tinymce_frame</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="nf">find_element</span><span class="p">(</span><span class="ss">:id</span> <span class="o">=&gt;</span> <span class="s1">'tinymce-editor_ifr'</span><span class="p">)</span></code></pre></figure> <h4 id="heading-switch-into">Switch into</h4> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">driver</span><span class="p">.</span><span class="nf">switch_to</span><span class="p">.</span><span class="nf">frame</span><span class="p">(</span><span class="n">ckeditor_frame</span><span class="p">)</span> <span class="c1"># ckeditor_frame or tinymce_frame, one at a time</span></code></pre></figure> <h4 id="heading-switch-out-if-necessary">Switch out (if necessary)</h4> <p>If the WebDriver instance is already inside any kind of frames, switch out the current frame to default content is required. For example, after switching into CKEditor's iframe and sending some keys, the only way to get into TinyMCE's input area is to switch back to default content first, then locate TinyMCE's iframe and switch into frame again.</p> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># if driver is already inside ckeditor_frame, switch out first</span>
<span class="n">driver</span><span class="p">.</span><span class="nf">switch_to</span><span class="p">.</span><span class="nf">default_content</span>

<span class="c1"># then switch to another iframe, e.g. tinymce_frame</span>
<span class="n">driver</span><span class="p">.</span><span class="nf">switch_to</span><span class="p">.</span><span class="nf">frame</span><span class="p">(</span><span class="n">tinymce_frame</span><span class="p">)</span></code></pre></figure> <h3 id="heading-automate-content">Automate content</h3> <h4 id="heading-send-keys">Send keys</h4> <p>After switching into the editor's <code class="language-plaintext highlighter-rouge">&lt;iframe&gt;</code>, the text can be sent to the <code class="language-plaintext highlighter-rouge">&lt;body&gt;</code> directly, which is possible using Selenium's native <code class="language-plaintext highlighter-rouge">send_keys</code> method. Unlike injecting JavaScript using editors' built-in methods or changing innerHTML, the keys sent into the editor will always be inside <code class="language-plaintext highlighter-rouge">&lt;p&gt;</code> tag. As a result, sending <code class="language-plaintext highlighter-rouge">&lt;h1&gt;Heading&lt;/h1&gt;</code> won't show up as real WYSIWYG heading, but in plain text. Furthermore, this approach has been reported behaving incorrectly on Firefox, which might be better to avoid if possible.</p> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">editor_body</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="nf">find_element</span><span class="p">(</span><span class="ss">:tag_name</span> <span class="o">=&gt;</span> <span class="s1">'body'</span><span class="p">)</span>
<span class="n">editor_body</span><span class="p">.</span><span class="nf">send_keys</span><span class="p">(</span><span class="s2">"&lt;h1&gt;Heading&lt;/h1&gt;Yi Zeng"</span><span class="p">)</span></code></pre></figure> <h4 id="heading-set-innerhtml">Set innerHTML</h4> <p>In order to set editor content with raw HTML like WYSIWYG mode, one approach is to change the innerHTML of editor body by injecting JavaScript. In this case, sending <code class="language-plaintext highlighter-rouge">&lt;h1&gt;Heading&lt;/h1&gt;</code> will actually show up as heading one.</p> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">editor_body</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="nf">find_element</span><span class="p">(</span><span class="ss">:css</span> <span class="o">=&gt;</span> <span class="s1">'body'</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="nf">execute_script</span><span class="p">(</span><span class="s2">"arguments[0].innerHTML = '&lt;h1&gt;Heading&lt;/h1&gt;Yi Zeng'"</span><span class="p">,</span> <span class="n">editor_body</span><span class="p">)</span></code></pre></figure> <h4 id="heading-clear-all-input">Clear all input</h4> <p>A quote from Selenium Ruby's API documentation on <a href="http://seleniumhq.github.io/selenium/docs/api/rb/Selenium/WebDriver/Element.html#clear-instance_method">clear() method</a>:</p> <blockquote> <p>If this element is a text entry element, this will clear the value. Has no effect on other elements.</p> </blockquote> <p>Although <code class="language-plaintext highlighter-rouge">clear()</code> method is stated as not available for non-text entry elements, it seems it can actually clear the input iframe without any exceptions.</p> <p>Apart from <code class="language-plaintext highlighter-rouge">clear()</code>, an alternative is to use Selenium's <a href="http://seleniumhq.github.io/selenium/docs/api/rb/Selenium/WebDriver/ActionBuilder.html">ActionBuilder</a> to construct an action chain to mimic keyboard shortcut pressing. <code class="language-plaintext highlighter-rouge">Ctrl + A</code> will select all, then push <code class="language-plaintext highlighter-rouge">Backspace</code> to clear.</p> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># Method 1. Using clear() method</span>
<span class="n">editor_body</span><span class="p">.</span><span class="nf">clear</span>

<span class="c1"># Method 2. Using ActionBuilder</span>
<span class="n">driver</span><span class="p">.</span><span class="nf">action</span><span class="p">.</span><span class="nf">click</span><span class="p">(</span><span class="n">editor_body</span><span class="p">)</span>
             <span class="p">.</span><span class="nf">key_down</span><span class="p">(</span><span class="ss">:control</span><span class="p">)</span>
             <span class="p">.</span><span class="nf">send_keys</span><span class="p">(</span><span class="s2">"a"</span><span class="p">)</span>
             <span class="p">.</span><span class="nf">key_up</span><span class="p">(</span><span class="ss">:control</span><span class="p">)</span>
             <span class="p">.</span><span class="nf">perform</span>
<span class="n">driver</span><span class="p">.</span><span class="nf">action</span><span class="p">.</span><span class="nf">send_keys</span><span class="p">(</span><span class="ss">:backspace</span><span class="p">).</span><span class="nf">perform</span></code></pre></figure> <h2 id="heading-automate-using-editors-built-in-javascript-api">Automate using editors' built-in JavaScript API</h2> <p>Without worrying about frame switching like using Selenium WebDriver's native API, it would also be a stable solution to inject JavaScript directly using <code class="language-plaintext highlighter-rouge">driver.execute_script()</code> to call editors' built-in JS functions.</p> <h3 id="heading-set-content">Set content</h3> <p>Both editors have built-in methods to set the content of entire input area. CKEditor's <a href="http://docs.ckeditor.com/#!/api/CKEDITOR.editor-method-setData">API</a> provides a method called <code class="language-plaintext highlighter-rouge">setData()</code>, which replaces editor data with raw input HTML data. Similar method <code class="language-plaintext highlighter-rouge">setContent()</code> also exists in TinyMCE editor's <a href="https://www.tinymce.com/docs/api/tinymce/tinymce.editor/#setcontent">API</a>.</p> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">driver</span><span class="p">.</span><span class="nf">execute_script</span><span class="p">(</span><span class="s2">"CKEDITOR.instances.ckeditor.setData('&lt;h1&gt;Yi Zeng&lt;/h1&gt; CKEditor')"</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="nf">execute_script</span><span class="p">(</span><span class="s2">"tinyMCE.activeEditor.setContent('&lt;h1&gt;Yi Zeng&lt;/h1&gt; TinyMCE')"</span><span class="p">)</span></code></pre></figure> <h3 id="heading-clear-content">Clear content</h3> <p>With the same logic, clearing content can be done by injecting JavaScript to set the entire content to empty string.</p> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">driver</span><span class="p">.</span><span class="nf">execute_script</span><span class="p">(</span><span class="s2">"CKEDITOR.instances.ckeditor.setData( '' )"</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="nf">execute_script</span><span class="p">(</span><span class="s2">"tinyMCE.activeEditor.setContent('')"</span><span class="p">)</span></code></pre></figure> <h3 id="heading-insert-content">Insert content</h3> <p>Instead of setting the entire content, it is also possible to insert some content to the editors. CKEditor's has a method called <code class="language-plaintext highlighter-rouge">insertHTML()</code>, which inserts content at currently selected position, in TinyMCE, it's called <code class="language-plaintext highlighter-rouge">insertContent()</code>.</p> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">driver</span><span class="p">.</span><span class="nf">execute_script</span><span class="p">(</span><span class="s2">"CKEDITOR.instances.ckeditor.insertHtml('&lt;p&gt;Christchurch&lt;/p&gt;')"</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="nf">execute_script</span><span class="p">(</span><span class="s2">"tinyMCE.activeEditor.insertContent('&lt;p&gt;Christchurch&lt;/p&gt;')"</span><span class="p">)</span></code></pre></figure> <h2 id="heading-examples">Examples</h2> <h3 id="heading-set-content-using-selenium-webdriver-api">Set content using Selenium WebDriver API</h3> <p><a class="button show-hidden">Show</a></p> <div class="hidden"> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># Environment tested</span>
<span class="c1"># Linux Mint 16, Selenium 2.41.0, Chromium 33.0, ChromeDriver 2.9</span>
<span class="nb">require</span> <span class="s1">'selenium-webdriver'</span>

<span class="n">driver</span> <span class="o">=</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="p">.</span><span class="nf">for</span> <span class="ss">:chrome</span>
<span class="n">driver</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="s1">'http://yizeng.me/2014/01/31/test-wysiwyg-editors-using-selenium-webdriver/'</span><span class="p">)</span>

<span class="n">ckeditor_frame</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="nf">find_element</span><span class="p">(</span><span class="ss">:class</span> <span class="o">=&gt;</span> <span class="s1">'cke_wysiwyg_frame'</span><span class="p">)</span>
<span class="n">tinymce_frame</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="nf">find_element</span><span class="p">(</span><span class="ss">:id</span> <span class="o">=&gt;</span> <span class="s1">'tinymce-editor_ifr'</span><span class="p">)</span>

<span class="c1"># Using JavaScript injection to set innerHTML, shown as WYSIWYG</span>
<span class="n">driver</span><span class="p">.</span><span class="nf">switch_to</span><span class="p">.</span><span class="nf">frame</span><span class="p">(</span><span class="n">ckeditor_frame</span><span class="p">)</span>
<span class="n">ck_editor_body</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="nf">find_element</span><span class="p">(</span><span class="ss">:tag_name</span> <span class="o">=&gt;</span> <span class="s1">'body'</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="nf">execute_script</span><span class="p">(</span><span class="s2">"arguments[0].innerHTML = '&lt;h1&gt;CKEditor&lt;/h1&gt;Yi Zeng'"</span><span class="p">,</span> <span class="n">ck_editor_body</span><span class="p">)</span>

<span class="n">driver</span><span class="p">.</span><span class="nf">switch_to</span><span class="p">.</span><span class="nf">default_content</span>

<span class="c1"># Using native 'send_keys' method, all content are wrapped with &lt;p&gt;</span>
<span class="n">driver</span><span class="p">.</span><span class="nf">switch_to</span><span class="p">.</span><span class="nf">frame</span><span class="p">(</span><span class="n">tinymce_frame</span><span class="p">)</span>
<span class="n">tinymce_body</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="nf">find_element</span><span class="p">(</span><span class="ss">:css</span> <span class="o">=&gt;</span> <span class="s1">'body'</span><span class="p">)</span>
<span class="n">tinymce_body</span><span class="p">.</span><span class="nf">send_keys</span><span class="p">(</span><span class="s1">'&lt;h1&gt;TInyMCE&lt;/h1&gt;Yi Zeng'</span><span class="p">)</span></code></pre></figure> </div> <h3 id="heading-select-all-content">Select all content</h3> <p><a class="button show-hidden">Show</a></p> <div class="hidden"> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># Environment tested</span>
<span class="c1"># Linux Mint 16, Selenium 2.41.0, Chromium 33.0, ChromeDriver 2.9</span>
<span class="nb">require</span> <span class="s1">'selenium-webdriver'</span>

<span class="n">driver</span> <span class="o">=</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="p">.</span><span class="nf">for</span> <span class="ss">:chrome</span>
<span class="n">driver</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="s1">'http://yizeng.me/2014/01/31/test-wysiwyg-editors-using-selenium-webdriver/'</span><span class="p">)</span>

<span class="n">driver</span><span class="p">.</span><span class="nf">switch_to</span><span class="p">.</span><span class="nf">frame</span><span class="p">(</span><span class="n">driver</span><span class="p">.</span><span class="nf">find_element</span><span class="p">(</span><span class="ss">:class</span> <span class="o">=&gt;</span> <span class="s1">'cke_wysiwyg_frame'</span><span class="p">))</span>

<span class="n">ck_editor_body</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="nf">find_element</span><span class="p">(</span><span class="ss">:tag_name</span> <span class="o">=&gt;</span> <span class="s1">'body'</span><span class="p">)</span>
<span class="n">ck_editor_body</span><span class="p">.</span><span class="nf">send_keys</span><span class="p">(</span><span class="s2">"Yi Zeng"</span><span class="p">)</span>

<span class="n">driver</span><span class="p">.</span><span class="nf">action</span><span class="p">.</span><span class="nf">click</span><span class="p">(</span><span class="n">ck_editor_body</span><span class="p">)</span>
             <span class="p">.</span><span class="nf">key_down</span><span class="p">(</span><span class="ss">:control</span><span class="p">)</span>
             <span class="p">.</span><span class="nf">send_keys</span><span class="p">(</span><span class="s2">"a"</span><span class="p">)</span>
             <span class="p">.</span><span class="nf">key_up</span><span class="p">(</span><span class="ss">:control</span><span class="p">)</span>
             <span class="p">.</span><span class="nf">perform</span></code></pre></figure> </div> <h3 id="heading-click-numbered-list-from-toolbar">Click "Numbered list" from toolbar</h3> <p><a class="button show-hidden">Show</a></p> <div class="hidden"> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># Environment tested</span>
<span class="c1"># Linux Mint 16, Selenium 2.41.0, Chromium 33.0, ChromeDriver 2.9</span>
<span class="nb">require</span> <span class="s1">'selenium-webdriver'</span>

<span class="n">driver</span> <span class="o">=</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="p">.</span><span class="nf">for</span> <span class="ss">:chrome</span>
<span class="n">driver</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="s1">'http://yizeng.me/2014/01/31/test-wysiwyg-editors-using-selenium-webdriver/'</span><span class="p">)</span>

<span class="c1"># click CKEditor's 'Numbered List' button</span>
<span class="n">ckeditor_btn_numbered_list</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="nf">find_element</span><span class="p">(</span><span class="ss">:class</span> <span class="o">=&gt;</span> <span class="s2">"cke_button__numberedlist"</span><span class="p">)</span>
<span class="n">ckeditor_btn_numbered_list</span><span class="p">.</span><span class="nf">click</span>

<span class="c1"># click TinyMCE editor's 'Numbered List' button</span>
<span class="n">tinymce_btn_numbered_list</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="nf">find_element</span><span class="p">(</span><span class="ss">:css</span> <span class="o">=&gt;</span> <span class="s2">".mce-btn[aria-label='Numbered list'] button"</span><span class="p">)</span>
<span class="n">tinymce_btn_numbered_list</span><span class="p">.</span><span class="nf">click</span></code></pre></figure> </div> <h3 id="heading-set-content-using-editors-api">Set content using editors' API</h3> <p><a class="button show-hidden">Show</a></p> <div class="hidden"> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># Environment tested</span>
<span class="c1"># Linux Mint 16, Selenium 2.41.0, Chromium 33.0, ChromeDriver 2.9</span>
<span class="nb">require</span> <span class="s1">'selenium-webdriver'</span>

<span class="n">driver</span> <span class="o">=</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="p">.</span><span class="nf">for</span> <span class="ss">:chrome</span>
<span class="n">driver</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="s1">'http://yizeng.me/2014/01/31/test-wysiwyg-editors-using-selenium-webdriver/'</span><span class="p">)</span>

<span class="n">driver</span><span class="p">.</span><span class="nf">execute_script</span><span class="p">(</span><span class="s2">"CKEDITOR.instances.ckeditor.setData('&lt;h1&gt;Yi Zeng&lt;/h1&gt; CKEditor')"</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="nf">execute_script</span><span class="p">(</span><span class="s2">"tinyMCE.activeEditor.setContent('&lt;h1&gt;Yi Zeng&lt;/h1&gt; TinyMCE')"</span><span class="p">)</span>

<span class="n">driver</span><span class="p">.</span><span class="nf">execute_script</span><span class="p">(</span><span class="s2">"CKEDITOR.instances.ckeditor.insertHtml('&lt;p&gt;Christchurch&lt;/p&gt;')"</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="nf">execute_script</span><span class="p">(</span><span class="s2">"tinyMCE.activeEditor.insertContent('&lt;p&gt;Christchurch&lt;/p&gt;')"</span><span class="p">)</span></code></pre></figure> </div> <h2 id="heading-references">References</h2> <ul> <li><a href="http://seleniumhq.github.io/selenium/docs/api/rb/index.html">Selenium Ruby binding API</a></li> <li><a href="https://github.com/SeleniumHQ/selenium/wiki/Ruby-Bindings">RubyBindings WikiPage</a></li> <li><a href="http://docs.ckeditor.com/">CKEditor 4 Documentation</a></li> <li><a href="http://www.tinymce.com/wiki.php">TinyMCE 4 Documentation</a></li> <li><a href="http://watirmelon.com/2011/08/12/automate-entering-text-into-wysiwyg-editors-using-watir-webdriver/">Automate entering text into WYSIWYG editors using Watir-WebDriver</a></li> </ul> </div> </div> </div> <footer class="unit-foot"> <div class="unit-inner unit-foot-inner"> <div class="post-buttons"> <a class="internal gotop" href="#page" title="Back to Top">Back to Top</a> <div class="addthis_toolbox addthis_default_style addthis_32x32_style"> <small class="label">Share Post:</small> <a class="btn-share-post addthis_button_email"></a> <a class="btn-share-post addthis_button_facebook"></a> <a class="btn-share-post addthis_button_google_plusone_share"></a> <a class="btn-share-post addthis_button_reddit"></a> <a class="btn-share-post addthis_button_twitter"></a> </div> <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-53819e27689934f9"></script> </div> <nav class="pagination"> <a class="internal" rel="prev" href="/2014/01/08/disable-javascript-using-selenium-webdriver/" title=" 'Disable JavaScript using Selenium WebDriver'"> ← Disable JavaScript using Selenium WebDriver</a> <a class="internal" rel="next" href="/2014/02/08/take-a-screenshot-on-exception-with-selenium-csharp-eventfiringwebdriver/" title="Next Post 'Take a screenshot on exception with Selenium C#'s EventFiringWebDriver'">Take a screenshot on exception with Selenium C#'s EventFiringWebDriver → </a> </nav> </div> </footer> <div class="misc-content"> <script>$(document).ready(function(){var b="ULZ0b9TFdfCUJSKQd4WCKv2v3u25YoG7YG8zXPewkWrT35lZ0Se9YnxLzoV6VM8W";var c="yizeng";var a="link:"+$(".comments .show-hidden").attr("data-disqus-url");$.ajax({type:"GET",url:"//disqus.com/api/3.0/threads/set.jsonp",data:{api_key:b,forum:c,thread:a},cache:false,dataType:"jsonp",success:function(d){if(d.response.length===1){btnText="Show Comments ("+d.response[0].posts+")";$(".comments .show-hidden").html(btnText)}}});$(".comments .show-hidden").on("click",function(){$.ajaxSetup({cache:true});$.getScript("//"+c+".disqus.com/embed.js");$.ajaxSetup({cache:false});$(this).remove()});if(/\#comments/.test(location.hash)){$(".comments .show-hidden").trigger("click")}});</script> <div class="comments"> <button class="center-block show-hidden" title="Show Comments" data-disqus-url="http://yizeng.me/2014/01/31/test-wysiwyg-editors-using-selenium-webdriver/">Show Comments</button> <div id="disqus_thread"></div> </div> </div> </div> </div> </article> </div> </div> </div> </div> <footer class="the-footer"> <div class="unit-foot"> <div class="unit-inner unit-foot-inner"> <div class="misc vcard"> <div class="about"> <h4><a href="/">About</a></h4> <p>Yi Zeng, a senior software engineer based in Berlin, Germany.</p> <p><small>Theme <a href="https://github.com/yizeng/jekyll-theme-simple-texture" target="_blank">Simple Texture</a> developed by <a href="http://yizeng.me" target="_blank">Yi Zeng</a>, powered by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a>.</small></p> </div> <div class="social-links"> <a class="ico-rss" href="/feed.xml" rel="me" target="_blank" title="feed"></a> <a class="ico-github" href="https://github.com/yizeng/" rel="me" target="_blank" title="github"></a> <a class="ico-linkedin" href="https://www.linkedin.com/in/yizengnz/" rel="me" target="_blank" title="linkedin"></a> <a class="ico-stackoverflow" href="https://stackoverflow.com/users/1177636/yi-zeng" rel="me" target="_blank" title="stackoverflow"></a> </div> </div> </div> </div> <a href="#" class="internal back-to-top">Back to Top</a> </footer> </div> <script>$(document).ready(function(){var c=50,b=500,a=960;$(window).scroll(function(){if($(window).width()>a){if($(this).scrollTop()>c){$("footer").css("top","20px");$("footer .back-to-top").fadeIn(b)}else{$("footer").css("top","auto");$("footer .back-to-top").fadeOut(b)}}});$(window).resize(function(){if($(window).width()<a){$("footer").css("top","auto");$("footer .back-to-top").fadeOut(b)}if($(window).width()>=a&&$(this).scrollTop()>c){$("footer").css("top","20px");$("footer .back-to-top").fadeIn(b)}});$("footer .back-to-top, .gotop").on("click",function(d){d.preventDefault();$("html, body").animate({scrollTop:0},b);return false});$(".show-hidden").on("click",function(){$(this).parent().next().toggleClass("hidden");$(this).toggleClass("hidden")})});</script> <script src="/assets/javascripts/jekyll-search.jquery.js"></script> <script>$(document).ready(function(){$(".search-field").simpleJekyllSearch({jsonFile:"/search.json",template:'<li><a href="{url}">{title} <span class="entry-date"><time datetime="{date}">{shortdate}</time></span></a></li>',searchResults:".search-wrapper .results",searchResultsTitle:"<h4>Search results</h4>",noResults:"<p>Oh shucks<br/><small>Nothing found :(</small></p>"})});(function(c,b,d){var a=function(){c(".nav-wrapper, .search-wrapper").removeAttr("style");c(".nav-form, .search-form").removeClass("active");c("body").removeClass("nav-overlay search-overlay")};c(".nav-global .btn-search").on("click",function(){c(".search-wrapper").css({display:"block"});c(".search-form").addClass("active");c(".search-form").find("input").focus();c("body").addClass("search-overlay")});c(".nav-global .btn-menu").on("click",function(){c(".nav-wrapper").css({display:"block"});c(".nav-form").addClass("active");c(".nav-form .search-field").prop("disabled",true);c("body").addClass("nav-overlay")});c(".nav-wrapper .btn-close, .search-wrapper .btn-close").on("click",function(){a()});c(document).on("keyup",function(f){if(f.keyCode===27){a()}})})(jQuery,window);</script> <script src='//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.js'></script> <script src='//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-buttons.min.js'></script> <script src="/assets/javascripts/unveil/jquery.unveil.min.js"></script> <script>window.jQuery.fancybox||document.write('<script src="/assets/javascripts/fancybox/jquery.fancybox.pack.js?v=2.1.4"><\/script>');window.jQuery.fancybox.helpers.buttons||document.write('<script src="/assets/javascripts/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"><\/script>');</script> <script>$("head").append('<link rel="stylesheet" href="/assets/javascripts/fancybox/jquery.fancybox.css?v=2.1.4" type="text/css" />');$("head").append('<link rel="stylesheet" href="/assets/javascripts/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" />');$(".post-image").fancybox({prevEffect:"none",nextEffect:"none",closeBtn:true,helpers:{title:{type:"float"}}});$(document).ready(function(){$(".post-image > img").unveil(450)});</script> </body> </html>