<!DOCTYPE html> <!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"><![endif]--> <!--[if IE 7]><html class="no-js lt-ie9 lt-ie8"><![endif]--> <!--[if IE 8]><html class="no-js lt-ie9"><![endif]--> <!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]--> <head> <meta charset="utf-8"> <!--[if IE]><meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'><![endif]--> <meta name="viewport" content="width=device-width,initial-scale=1"> <title>Download PDF files automatically in Firefox using Selenium WebDriver | Yi Zeng’s Blog</title> <meta name="generator" content="Jekyll v3.9.3"/> <meta property="og:title" content="Download PDF files automatically in Firefox using Selenium WebDriver"/> <meta name="author" content="Yi Zeng"/> <meta property="og:locale" content="en"/> <meta name="description" content="Instead of dealing with &#39;Save file&#39; dialog or in-browser PDF previewing, this tutorial will demonstrate how to download PDF files automatically in Firefox using Selenium WebDriver."/> <meta property="og:description" content="Instead of dealing with &#39;Save file&#39; dialog or in-browser PDF previewing, this tutorial will demonstrate how to download PDF files automatically in Firefox using Selenium WebDriver."/> <link rel="canonical" href="http://yizeng.me/2014/05/23/download-pdf-files-automatically-in-firefox-using-selenium-webdriver/"/> <meta property="og:url" content="http://yizeng.me/2014/05/23/download-pdf-files-automatically-in-firefox-using-selenium-webdriver/"/> <meta property="og:site_name" content="Yi Zeng’s Blog"/> <meta property="og:type" content="article"/> <meta property="article:published_time" content="2014-05-23T00:00:00+02:00"/> <meta name="twitter:card" content="summary"/> <meta property="twitter:title" content="Download PDF files automatically in Firefox using Selenium WebDriver"/> <script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Yi Zeng"},"dateModified":"2014-05-23T00:00:00+02:00","datePublished":"2014-05-23T00:00:00+02:00","description":"Instead of dealing with &#39;Save file&#39; dialog or in-browser PDF previewing, this tutorial will demonstrate how to download PDF files automatically in Firefox using Selenium WebDriver.","headline":"Download PDF files automatically in Firefox using Selenium WebDriver","mainEntityOfPage":{"@type":"WebPage","@id":"http://yizeng.me/2014/05/23/download-pdf-files-automatically-in-firefox-using-selenium-webdriver/"},"url":"http://yizeng.me/2014/05/23/download-pdf-files-automatically-in-firefox-using-selenium-webdriver/"}</script> <meta name="keywords" content="firefox,ruby,selenium webdriver"/> <link type="application/atom+xml" rel="alternate" href="http://yizeng.me/feed.xml" title="Yi Zeng’s Blog"/> <link href='/assets/stylesheets/blog.css' rel="stylesheet" type="text/css"> <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script> <script>window.Modernizr||document.write('<script src="/assets/javascripts/modernizr-2.8.3.min.js"><\/script>');</script> <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> <script>window.jQuery||document.write('<script src="/assets/javascripts/jquery-3.3.1.min.js"><\/script>');</script> <script src="//cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script> <script>window.Pace||document.write('<script src="/assets/javascripts/pace.min.js"><\/script>');</script> <script>(function(b,m,h,a,g){b[a]=b[a]||[];b[a].push({"gtm.start":new Date().getTime(),event:"gtm.js"});var k=m.getElementsByTagName(h)[0],e=m.createElement(h),c=a!="dataLayer"?"&l="+a:"";e.async=true;e.src="https://www.googletagmanager.com/gtm.js?id="+g+c;k.parentNode.insertBefore(e,k)})(window,document,"script","dataLayer","GTM-P5NFP45");</script> </head> <body> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P5NFP45" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript> <!--[if IE]><p class="site-notice">You are using an outdated browser. Please <a href="http://browsehappy.com/" target="_blank">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true" target="_blank">activate Google Chrome Frame</a> to improve your experience.</p><![endif]--> <noscript> <p class="site-notice">This site requires JavaScript. Here are the instructions <a href="http://www.enable-javascript.com/" target="_blank">how to enable JavaScript in your web browser</a>.</p> </noscript> <div class="nav-wrapper overlay-wrapper"> <div class="nav-form overlay-form"> <span class="overlay-header menu">Menu</span> <a class="btn-close">Close</a> <div class="results"> <ul> <li><a href="/blog/categories/">Categories</a></li> <li><a href="/blog/tags/">Tags</a></li> <li><a href="/">About</a></li> </ul> </div> </div> </div> <div class="search-wrapper overlay-wrapper"> <div class="search-form overlay-form"> <input type="text" class="overlay-header search-field" placeholder="Search..."> <a class="btn-close">Close</a> <ul class="results"></ul> </div> </div> <div id="page" class="hentry"> <header class="the-header"> <div class="unit-head"> <div class="unit-inner unit-head-inner"> <nav class="nav-global"> <ul> <li class="logo nav-link"> <button class="btn-menu" title="Menu"></button> <a href="/blog/">Yi Zeng’s Blog</a> <!--[if !IE]>--> <button class="btn-search" title="Search"></button> <!--<![endif]--> </li> <li class="nav-link"><a title="Categories" href="/blog/categories/">Categories</a></li> <li class="nav-link"><a title="Tags" href="/blog/tags/">Tags</a></li> <!--[if !IE]>--> <li class="nav-link"><a title="Search" class="btn-search" href="#">Search</a></li> <!--<![endif]--> </ul> </nav> </div> </div> </header> <div class="body animated fadeInDown" role="main"> <div class="unit-body"> <div class="unit-inner unit-body-inner"> <div class="entry-content"> <article class="unit-article layout-post"> <div class="unit-inner unit-article-inner"> <div itemscope itemtype="http://schema.org/Article" class="content"> <header> <div class="unit-head"> <div class="unit-inner unit-head-inner"> <h1 class="entry-title" itemprop="name">Download PDF files automatically in Firefox using Selenium WebDriver</h1> </div> </div> </header> <div class="bd article-content"> <div class="entry-content"> <div class="meta"> <p class="date-publish"> Published: <time itemprop="datePublished" class="date-pub updated" title="2014-05-23T00:00:00+02:00" datetime="2014-05-23T00:00:00+02:00">May 23, 2014 </time> by <a class="author" href="/" rel="author" title="Show Author"> <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name">Yi Zeng</span> </span> </a> <a class="license-icon" rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" title="Show License"> <img alt="Creative Commons Licence" style="border-width:0" src="/assets/images/theme/cc-by-sa.png" height="16" width="80"/> </a> </p> <ul class="list-category list-linear"> <li class="list-head">Categories: </li> <li> <a href="/blog/categories/#tutorials" title="tutorials"> tutorials <span>26</span></a> </li> </ul> <ul class="list-tag list-linear"> <li class="list-head">Tags: </li> <li> <a href="/blog/tags/#firefox" title="firefox">firefox <span>1</span></a> </li> <li> <a href="/blog/tags/#ruby" title="ruby">ruby <span>14</span></a> </li> <li> <a href="/blog/tags/#selenium-webdriver" title="selenium webdriver">selenium webdriver <span>16</span></a> </li> </ul> </div> <div itemprop="articleBody"> <h2 id="heading-a-complete-example">A complete example</h2> <p>For those who are willing to learn by examples right away, here is a complete example of how to save PDF files automatically in Firefox using Selenium WebDriver.</p> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># Environment Tested:</span>
<span class="c1"># Windows 7, Ruby 2.0.0p451, Selenium 2.41.0, Firefox 29.0.1</span>
<span class="nb">require</span> <span class="s1">'selenium-webdriver'</span>

<span class="n">profile</span> <span class="o">=</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="o">::</span><span class="no">Firefox</span><span class="o">::</span><span class="no">Profile</span><span class="p">.</span><span class="nf">new</span>
<span class="n">profile</span><span class="p">[</span><span class="s2">"browser.download.folderList"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">profile</span><span class="p">[</span><span class="s2">"browser.download.dir"</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'C:\\'</span>
<span class="n">profile</span><span class="p">[</span><span class="s2">"browser.helperApps.neverAsk.saveToDisk"</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'application/pdf'</span>

<span class="c1"># disable Firefox's built-in PDF viewer</span>
<span class="n">profile</span><span class="p">[</span><span class="s2">"pdfjs.disabled"</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>

<span class="c1"># disable Adobe Acrobat PDF preview plugin</span>
<span class="n">profile</span><span class="p">[</span><span class="s2">"plugin.scan.plid.all"</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">profile</span><span class="p">[</span><span class="s2">"plugin.scan.Acrobat"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"99.0"</span>

<span class="n">driver</span> <span class="o">=</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="p">.</span><span class="nf">for</span> <span class="ss">:firefox</span><span class="p">,</span> <span class="ss">:profile</span> <span class="o">=&gt;</span> <span class="n">profile</span>
<span class="n">driver</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="s1">'http://static.mozilla.com/moco/en-US/pdf/mozilla_privacypolicy.pdf'</span><span class="p">)</span></code></pre></figure> <h2 id="heading-a-walk-through">A walk-through</h2> <h3 id="heading-prevent-firefox-from-popping-up-save-file-dialog">Prevent Firefox from popping up "Save file" dialog</h3> <p>As Selenium itself doesn't interact with system-level dialogs, in order to download PDFs as part of the browser automation process, it requires the help from either additional frameworks or an approach that handles downloading automatically.</p> <p><a class="post-image" href="/assets/images/posts/2014-05-23-firefox-save-file-dialog.png" title="'Save file' dialog in Firefox"> <img itemprop="image" data-src="/assets/images/posts/2014-05-23-firefox-save-file-dialog.png" src="/assets/javascripts/unveil/loader.gif" alt="'Save file' dialog in Firefox"/> </a></p> <p>Firefox's <a href="https://developer.mozilla.org/en/docs/Download_Manager_preferences">download manager preferences</a> are controlled by some properties defined in <a href="http://kb.mozillazine.org/About:config"><code class="language-plaintext highlighter-rouge">about:config</code></a> page, which can be set programmatically while instantiating <code class="language-plaintext highlighter-rouge">FirefoxDriver</code> using Selenium WebDriver.</p> <ul> <li><code class="language-plaintext highlighter-rouge">browser.download.folderList</code> controls the default folder to download a file to. <code class="language-plaintext highlighter-rouge">0</code> indicates the Desktop; <code class="language-plaintext highlighter-rouge">1</code> indicates the systems default downloads location; <code class="language-plaintext highlighter-rouge">2</code> indicates a custom folder.</li> <li><code class="language-plaintext highlighter-rouge">browser.download.dir</code> holds the custom destination folder for downloading. It is activated if <code class="language-plaintext highlighter-rouge">browser.download.folderList</code> has been set to <code class="language-plaintext highlighter-rouge">2</code>.</li> <li><code class="language-plaintext highlighter-rouge">browser.helperApps.neverAsk.saveToDisk</code> stores a comma-separated list of MIME types to save to disk without asking what to use to open the file.</li> </ul> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">profile</span> <span class="o">=</span> <span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="o">::</span><span class="no">Firefox</span><span class="o">::</span><span class="no">Profile</span><span class="p">.</span><span class="nf">new</span>
<span class="n">profile</span><span class="p">[</span><span class="s2">"browser.download.folderList"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># use the custom folder defined in "browser.download.dir" below</span>
<span class="n">profile</span><span class="p">[</span><span class="s2">"browser.download.dir"</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'C:\\'</span>
<span class="n">profile</span><span class="p">[</span><span class="s2">"browser.helperApps.neverAsk.saveToDisk"</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'application/pdf'</span></code></pre></figure> <p>It is worth noting that the <a href="http://tools.ietf.org/html/rfc2046">MIME type</a> defined here is <code class="language-plaintext highlighter-rouge">application/pdf</code>, which is a type that most PDF files use. However, if the target PDF file has a non-standard MIME type, then "Save file" dialog might still show up. In order to fix this issue, the actual MIME type has to be added into <code class="language-plaintext highlighter-rouge">browser.helperApps.neverAsk.saveToDisk</code> property, which can be checked out using either of the following approaches:</p> <ul> <li>Upload file to online tools like <a href="http://mime.ritey.com/">What MIME?</a></li> <li>Download file and monitor MIME type in Chrome's developer tool or web debugging proxy like <a href="http://www.telerik.com/fiddler">Fiddler</a>, <a href="http://www.charlesproxy.com/">Charles</a>, etc.</li> </ul> <h3 id="heading-prevent-firefox-from-previewing-pdfs">Prevent Firefox from previewing PDFs</h3> <h4 id="heading-for-built-in-pdfjs-viewer">For built-in PDF.js viewer</h4> <p>With the release of Firefox 19.0, <a href="https://github.com/mozilla/pdf.js/">PDF.js</a> has been integrated into Firefox to provide built-in ability of displaying PDF files inside browser. It tries to parse and render PDFs into HTML5, which can be automated using Selenium WebDriver in theory. However, to download PDFs instead of preview in Firefox, another <a href="http://kb.mozillazine.org/About:config"><code class="language-plaintext highlighter-rouge">about:config</code></a> entry needs to be changed to disable PDF.js.</p> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">profile</span><span class="p">[</span><span class="s2">"pdfjs.disabled"</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span></code></pre></figure> <h4 id="heading-for-third-party-pdf-viewers">For third party PDF viewers</h4> <p>Except for Firefox's built-in PDF viewer, there might be other third party plugins preventing Firefox from downloading PDFs automatically. If a machine has <a href="http://get.adobe.com/uk/reader/">Adobe Reader</a> installed, then default PDF viewing setting in Firefox might have been set to Adobe Acrobat without notice.</p> <p>To avoid previewing PDFs with those plugins, two more <a href="http://kb.mozillazine.org/About:config"><code class="language-plaintext highlighter-rouge">about:config</code></a> entries need to be configured when starting WebDriver instance.</p> <ul> <li><code class="language-plaintext highlighter-rouge">plugin.scan.plid.all</code> needs to be <code class="language-plaintext highlighter-rouge">false</code>, so that Firefox won't scan and load plugins.</li> <li><code class="language-plaintext highlighter-rouge">plugin.scan.Acrobat</code> is a key that holds the minimum allowed version number that Adobe Acrobat is allowed to launch. Setting it to a number larger than currently installed Adobe Acrobat version should do the trick.</li> </ul> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">profile</span><span class="p">[</span><span class="s2">"plugin.scan.plid.all"</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">profile</span><span class="p">[</span><span class="s2">"plugin.scan.Acrobat"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"99.0"</span></code></pre></figure> </div> </div> </div> <footer class="unit-foot"> <div class="unit-inner unit-foot-inner"> <div class="post-buttons"> <a class="internal gotop" href="#page" title="Back to Top">Back to Top</a> <div class="addthis_toolbox addthis_default_style addthis_32x32_style"> <small class="label">Share Post:</small> <a class="btn-share-post addthis_button_email"></a> <a class="btn-share-post addthis_button_facebook"></a> <a class="btn-share-post addthis_button_google_plusone_share"></a> <a class="btn-share-post addthis_button_reddit"></a> <a class="btn-share-post addthis_button_twitter"></a> </div> <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-53819e27689934f9"></script> </div> <nav class="pagination"> <a class="internal" rel="prev" href="/2014/05/03/use-a-button-to-display-disqus-comments-count-and-load-comments-onclick/" title=" 'Use a button to display Disqus comments count and load comments onClick'"> ← Use a button to display Disqus comments count and load comments onClick</a> <a class="internal" rel="next" href="/2014/07/19/why-you-shouldnt-start-learning-selenium-by-automating-googles-products/" title="Next Post 'Why you shouldn't start learning Selenium by automating Google's products?'">Why you shouldn't start learning Selenium by automating Google's products? → </a> </nav> </div> </footer> <div class="misc-content"> <script>$(document).ready(function(){var b="ULZ0b9TFdfCUJSKQd4WCKv2v3u25YoG7YG8zXPewkWrT35lZ0Se9YnxLzoV6VM8W";var c="yizeng";var a="link:"+$(".comments .show-hidden").attr("data-disqus-url");$.ajax({type:"GET",url:"//disqus.com/api/3.0/threads/set.jsonp",data:{api_key:b,forum:c,thread:a},cache:false,dataType:"jsonp",success:function(d){if(d.response.length===1){btnText="Show Comments ("+d.response[0].posts+")";$(".comments .show-hidden").html(btnText)}}});$(".comments .show-hidden").on("click",function(){$.ajaxSetup({cache:true});$.getScript("//"+c+".disqus.com/embed.js");$.ajaxSetup({cache:false});$(this).remove()});if(/\#comments/.test(location.hash)){$(".comments .show-hidden").trigger("click")}});</script> <div class="comments"> <button class="center-block show-hidden" title="Show Comments" data-disqus-url="http://yizeng.me/2014/05/23/download-pdf-files-automatically-in-firefox-using-selenium-webdriver/">Show Comments</button> <div id="disqus_thread"></div> </div> </div> </div> </div> </article> </div> </div> </div> </div> <footer class="the-footer"> <div class="unit-foot"> <div class="unit-inner unit-foot-inner"> <div class="misc vcard"> <div class="about"> <h4><a href="/">About</a></h4> <p>Yi Zeng, a senior software engineer based in Berlin, Germany.</p> <p><small>Theme <a href="https://github.com/yizeng/jekyll-theme-simple-texture" target="_blank">Simple Texture</a> developed by <a href="http://yizeng.me" target="_blank">Yi Zeng</a>, powered by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a>.</small></p> </div> <div class="social-links"> <a class="ico-rss" href="/feed.xml" rel="me" target="_blank" title="feed"></a> <a class="ico-github" href="https://github.com/yizeng/" rel="me" target="_blank" title="github"></a> <a class="ico-linkedin" href="https://www.linkedin.com/in/yizengnz/" rel="me" target="_blank" title="linkedin"></a> <a class="ico-stackoverflow" href="https://stackoverflow.com/users/1177636/yi-zeng" rel="me" target="_blank" title="stackoverflow"></a> </div> </div> </div> </div> <a href="#" class="internal back-to-top">Back to Top</a> </footer> </div> <script>$(document).ready(function(){var c=50,b=500,a=960;$(window).scroll(function(){if($(window).width()>a){if($(this).scrollTop()>c){$("footer").css("top","20px");$("footer .back-to-top").fadeIn(b)}else{$("footer").css("top","auto");$("footer .back-to-top").fadeOut(b)}}});$(window).resize(function(){if($(window).width()<a){$("footer").css("top","auto");$("footer .back-to-top").fadeOut(b)}if($(window).width()>=a&&$(this).scrollTop()>c){$("footer").css("top","20px");$("footer .back-to-top").fadeIn(b)}});$("footer .back-to-top, .gotop").on("click",function(d){d.preventDefault();$("html, body").animate({scrollTop:0},b);return false});$(".show-hidden").on("click",function(){$(this).parent().next().toggleClass("hidden");$(this).toggleClass("hidden")})});</script> <script src="/assets/javascripts/jekyll-search.jquery.js"></script> <script>$(document).ready(function(){$(".search-field").simpleJekyllSearch({jsonFile:"/search.json",template:'<li><a href="{url}">{title} <span class="entry-date"><time datetime="{date}">{shortdate}</time></span></a></li>',searchResults:".search-wrapper .results",searchResultsTitle:"<h4>Search results</h4>",noResults:"<p>Oh shucks<br/><small>Nothing found :(</small></p>"})});(function(c,b,d){var a=function(){c(".nav-wrapper, .search-wrapper").removeAttr("style");c(".nav-form, .search-form").removeClass("active");c("body").removeClass("nav-overlay search-overlay")};c(".nav-global .btn-search").on("click",function(){c(".search-wrapper").css({display:"block"});c(".search-form").addClass("active");c(".search-form").find("input").focus();c("body").addClass("search-overlay")});c(".nav-global .btn-menu").on("click",function(){c(".nav-wrapper").css({display:"block"});c(".nav-form").addClass("active");c(".nav-form .search-field").prop("disabled",true);c("body").addClass("nav-overlay")});c(".nav-wrapper .btn-close, .search-wrapper .btn-close").on("click",function(){a()});c(document).on("keyup",function(f){if(f.keyCode===27){a()}})})(jQuery,window);</script> <script src='//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.js'></script> <script src='//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-buttons.min.js'></script> <script src="/assets/javascripts/unveil/jquery.unveil.min.js"></script> <script>window.jQuery.fancybox||document.write('<script src="/assets/javascripts/fancybox/jquery.fancybox.pack.js?v=2.1.4"><\/script>');window.jQuery.fancybox.helpers.buttons||document.write('<script src="/assets/javascripts/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"><\/script>');</script> <script>$("head").append('<link rel="stylesheet" href="/assets/javascripts/fancybox/jquery.fancybox.css?v=2.1.4" type="text/css" />');$("head").append('<link rel="stylesheet" href="/assets/javascripts/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" />');$(".post-image").fancybox({prevEffect:"none",nextEffect:"none",closeBtn:true,helpers:{title:{type:"float"}}});$(document).ready(function(){$(".post-image > img").unveil(450)});</script> </body> </html>